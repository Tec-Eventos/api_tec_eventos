const pool=require("../config/database");module.exports={create:(e,o)=>{pool.query("INSERT INTO aluno(rm_aluno, nome, email, telefone, cep_aluno, senha, cd_escolar)\n          VALUES(?,?,?,?,?,?,?)",[e.rm_aluno,e.nome,e.email,e.telefone,e.cep_aluno,e.senha,e.cd_escolar],((e,n,l)=>e?o(e):o(null,n)))},getUsers:e=>{pool.query("SELECT rm_aluno, nome, email, telefone, cep_aluno, senha, cd_escolar FROM aluno",[],((o,n,l)=>o?e(o):e(null,n)))},getUserById:(e,o)=>{pool.query("SELECT rm_aluno, nome, email, telefone, cep_aluno, senha, cd_escolar FROM aluno WHERE rm_aluno = ?",[e],((e,n,l)=>e?o(e):o(null,n[0])))},updateUser:(e,o)=>{console.log("Data for update:",e),pool.query("UPDATE aluno SET nome=?, email=?, telefone=?, cep_aluno=?, senha=?, cd_escolar=? WHERE rm_aluno= ?",[e.nome,e.email,e.telefone,e.cep_aluno,e.senha,e.cd_escolar,e.rm_aluno],((e,n,l)=>e?o(e):o(null,n)))},deleteUser:(e,o)=>{console.log("Data for delete:",e),pool.query("DELETE FROM aluno WHERE rm_aluno = ?",[e.rm_aluno],((e,n,l)=>e?o(e):o(null,n[0])))},getUserByRM:(e,o)=>{pool.query("SELECT * FROM aluno WHERE rm_aluno = ?",[e],((e,n,l)=>e?(console.log("DB Error:",e),o(e)):(console.log("DB Results:",n),o(null,n[0]))))},getAllEventsUser:(e,o)=>{pool.query("SELECT \n        ev.cd_evento, \n        ev.nome_evento, \n        ev.cd_instituicao, \n        ev.data_evento, \n        ev.horario, \n        ev.quantidade_ingressos, \n        ev.descricao, \n        ev.cep_evento,\n        ins.instituicao, \n        ins.tipo_instituicao,\n        ie.imagem AS imagem_evento,\n        le.imagem AS logo_evento\n    FROM \n        presenca_evento pe\n        JOIN evento ev ON pe.cd_evento = ev.cd_evento\n        JOIN instituicao ins ON ev.cd_instituicao = ins.cd_escolar\n        LEFT JOIN imagem_evento ie ON ev.cd_evento = ie.cd_evento AND ie.principal = 1\n        LEFT JOIN imagem_evento le ON ev.cd_evento = le.cd_evento AND le.logo_evento = 1\n    WHERE \n        pe.rm_aluno = ?",[e],((e,n,l)=>e?o(e):o(null,n)))}};