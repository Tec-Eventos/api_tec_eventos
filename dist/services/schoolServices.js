const pool=require("../config/database");module.exports={create:(e,o)=>{pool.query("INSERT INTO instituicao(cd_escolar, cnpj, instituicao, tipo_instituicao, cep_inst, telefone, email, senha) \n            VALUES (?,?,?,?,?,?,?,?)",[e.cd_escolar,e.cnpj,e.instituicao,e.tipo_instituicao,e.cep_inst,e.telefone,e.email,e.senha],((e,i,n)=>e?o(e):o(null,i)))},getSchools:e=>{pool.query("SELECT cd_escolar, cnpj, instituicao, tipo_instituicao, cep_inst, telefone, email, senha FROM instituicao",[],((o,i,n)=>o?e(o):e(null,i)))},getSchoolById:(e,o)=>{pool.query("SELECT cd_escolar, cnpj, instituicao, tipo_instituicao, cep_inst, telefone, email, senha FROM instituicao WHERE cd_escolar = ?",[e],((e,i,n)=>e?o(e):o(null,i[0])))},getAllEventsSchoolDo:(e,o)=>{pool.query("\n            SELECT \n            ev.cd_evento, \n            ev.nome_evento, \n            ev.cd_instituicao, \n            ev.data_evento, \n            ev.horario, \n            ev.quantidade_ingressos, \n            ev.descricao, \n            ev.cep_evento,\n            ev.preco,\n            ev.senha_evento,\n            ins.instituicao, \n            ins.tipo_instituicao,\n            ie.imagem AS imagem_evento,\n            le.imagem AS logo_evento\n        FROM \n            evento ev\n            JOIN instituicao ins ON ev.cd_instituicao = ins.cd_escolar\n            LEFT JOIN imagem_evento ie ON ev.cd_evento = ie.cd_evento AND ie.principal = 1\n            LEFT JOIN imagem_evento le ON ev.cd_evento = le.cd_evento AND le.logo_evento = 1\n        WHERE \n            ev.cd_instituicao = ?",[e],((e,i,n)=>e?o(e):o(null,i)))},updateSchool:(e,o)=>{console.log("Data for updata:",e),pool.query("UPDATE instituicao SET cnpj=?, instituicao=?, tipo_instituicao=?, cep_inst=?, telefone=?, email=?, senha=? WHERE cd_escolar=?",[e.cnpj,e.instituicao,e.tipo_instituicao,e.cep_inst,e.telefone,e.email,e.senha,e.cd_escolar],((e,i,n)=>e?o(e):o(null,i)))},deleteSchool:(e,o)=>{console.log("Data for delete:",e),pool.query("DELETE FROM instituicao WHERE cd_escolar=?",[e.cdEscolar],((e,i,n)=>e?o(e):o(null,i[0])))},getSchoolByCdEscolar:(e,o)=>{pool.query("SELECT * FROM instituicao WHERE cd_escolar = ?",[e],((e,i,n)=>e?(console.log("DB Error:",e),o(e)):(console.log("DB Results:",i),o(null,i[0]))))}};